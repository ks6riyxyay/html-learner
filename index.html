<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>W3Clone LMS GODMODE</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.8.0/dist/transformers.min.js"></script>

<style>
:root{--g:#04aa6d;--bg:#fff;--tx:#000;--p:#f1f1f1}
body.dark{--bg:#1d1f27;--tx:#eee;--p:#2b2e3b}
body{margin:0;font-family:Segoe UI;background:var(--bg);color:var(--tx)}
.top{display:flex;justify-content:space-between;padding:10px 20px;border-bottom:1px solid #ccc}
.logo{font-size:26px;font-weight:900;color:var(--g)}
.wrap{display:flex;height:calc(100vh - 50px)}
.side{width:330px;background:var(--p);overflow:auto}
.side h4{margin:15px}
.side a{display:block;padding:8px 15px;cursor:pointer}
.side a.locked{opacity:.4;pointer-events:none}
.side a.active{background:var(--g);color:#fff}
.main{flex:1;padding:25px;overflow:auto}
.btn{background:var(--g);color:#fff;border:none;padding:6px 12px;font-weight:bold;cursor:pointer}
.editor{background:#e7e9eb;padding:12px;border-left:5px solid var(--g);margin:12px 0}
textarea{width:100%;height:140px;font-family:monospace}
iframe{width:100%;height:200px;border:1px solid #ccc}
.box{background:var(--p);padding:12px;margin:12px 0;border-radius:5px}
.progress{font-size:13px;margin-bottom:10px}
</style>
</head>

<body>
<div class="top">
<div class="logo">W3Clone LMS</div>
<div>
<button class="btn" onclick="toggleDark()">üåô</button>
<button class="btn" onclick="voice()">üé§</button>
</div>
</div>

<div class="wrap">
<div class="side" id="side"></div>
<div class="main" id="main"></div>
</div>

<script>
/* ---------- AI ---------- */
let ai;
(async()=>ai=await transformers.pipeline("text-generation","Xenova/distilgpt2"))();

/* ---------- USER ---------- */
let user=localStorage.user||prompt("Username:");
localStorage.user=user;
let data=JSON.parse(localStorage[user]||'{"done":[],"score":0}');
function saveUser(){localStorage[user]=JSON.stringify(data)}

/* ---------- CURRICULUM ---------- */
const lessons=[
...["HTML"].flatMap(c=>[
"What is HTML","Structure","Headings","Paragraphs","Text Formatting","Links","Images",
"Lists","Tables","Forms","Inputs","Buttons","Div vs Span","Semantic HTML",
"Meta Tags","Media","Iframes","Best Practices","Accessibility","SEO"
].map(t=>c+": "+t)),
...["CSS"].flatMap(c=>[
"What is CSS","Syntax","Selectors","Colors","Units","Box Model","Borders","Margins",
"Padding","Fonts","Text","Display","Position","Flexbox","Grid","Responsive Design",
"Media Queries","Animations","Variables","Best Practices"
].map(t=>c+": "+t)),
...["JavaScript"].flatMap(c=>[
"What is JS","Variables","Data Types","Operators","Conditions","Loops","Functions",
"Scope","Events","DOM","DOM Manipulation","Forms","Arrays","Objects","JSON",
"Fetch API","Async Await","LocalStorage","Errors","Best Practices"
].map(t=>c+": "+t))
];

/* ---------- SIDEBAR ---------- */
const side=document.getElementById("side");
lessons.forEach((l,i)=>{
const a=document.createElement("a");
a.textContent=l;
a.onclick=()=>load(i);
a.id="l"+i;
side.appendChild(a);
});
side.innerHTML+=`
<h4>Exams</h4>
<a onclick="exam()">Final Exam</a>
<a onclick="certificate()">üéì Certificate</a>
<h4>Leaderboard</h4>
<a onclick="leaderboard()">üèÜ View</a>`;

/* ---------- LOAD ---------- */
function load(i){
if(i>data.done.length)return alert("Complete previous lesson üîí");
document.querySelectorAll(".side a").forEach(a=>a.classList.remove("active"));
document.getElementById("l"+i).classList.add("active");

main.innerHTML=`
<div class="progress">Progress: ${Math.round(data.done.length/lessons.length*100)}%</div>
<h1>${lessons[i]}</h1>

<div class="editor">
<textarea>${example(lessons[i])}</textarea>
<button class="btn" onclick="run(this)">Run</button>
<iframe></iframe>
</div>

<button class="btn" onclick="complete(${i})">‚úî Complete Lesson</button>

<div class="box">
<button class="btn" onclick="review()">ü§ñ AI Code Review</button>
<div id="aiout"></div>
</div>`;
}

/* ---------- EXAMPLES ---------- */
function example(t){
if(t.includes("HTML"))return "<h1>Hello</h1>";
if(t.includes("CSS"))return "<style>h1{color:red}</style><h1>Hi</h1>";
return "<button onclick='alert(1)'>Click</button>";
}

/* ---------- COMPLETE ---------- */
function complete(i){
if(!data.done.includes(i)){data.done.push(i);saveUser();}
alert("Lesson completed ‚úî");
}

/* ---------- SANDBOX ---------- */
function run(b){b.nextElementSibling.srcdoc=b.previousElementSibling.value}

/* ---------- AI ---------- */
async function review(){
aiout.textContent="Reviewing...";
const r=await ai("Review this beginner web code",{max_new_tokens:80});
aiout.textContent=r[0].generated_text;
}

/* ---------- EXAM ---------- */
async function exam(){
if(data.done.length<lessons.length)return alert("Finish all lessons first üîí");
main.innerHTML="<h1>Final Exam</h1><button class='btn' onclick='passExam()'>Submit Exam</button>";
}
function passExam(){
data.score=100;saveUser();
alert("Exam passed!");
}

/* ---------- CERTIFICATE ---------- */
function certificate(){
if(data.score<100)return alert("Finish ALL lessons and exam üîí");
const c=document.createElement("canvas");
c.width=800;c.height=400;
const x=c.getContext("2d");
x.fillStyle="#fff";x.fillRect(0,0,800,400);
x.fillStyle="#000";x.font="36px serif";
x.fillText("Certificate of Completion",150,150);
x.font="22px serif";
x.fillText(user,350,230);
const a=document.createElement("a");
a.href=c.toDataURL();a.download="certificate.png";a.click();
}

/* ---------- LEADERBOARD ---------- */
function leaderboard(){
let html="<h1>Leaderboard</h1>";
Object.keys(localStorage).forEach(k=>{
try{
const d=JSON.parse(localStorage[k]);
if(d.done)html+=`<p>${k}: ${d.done.length}</p>`;
}catch{}
});
main.innerHTML=html;
}

/* ---------- VOICE ---------- */
function voice(){
const r=new webkitSpeechRecognition();
r.onresult=e=>alert("Voice: "+e.results[0][0].transcript);
r.start();
}

/* ---------- DARK ---------- */
function toggleDark(){document.body.classList.toggle("dark")}

/* ---------- START ---------- */
load(data.done.length||0);
</script>
</body>
</html>
